<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kitchen Kombat</title>
    
    <!-- Bootstrap CSS CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" xintegrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    
    <!-- Google Fonts for a modern look -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&family=Press+Start+2P&display=swap" rel="stylesheet">

    <style>
        /* Custom styles for our game */
        body {
            background-color: #f0f2f5; /* A light, clean background */
            font-family: 'Roboto', sans-serif;
            color: #333;
        }

        .game-title {
            font-family: 'Press Start 2P', cursive;
            color: #4A4A4A;
            text-shadow: 2px 2px #E0E0E0;
        }

        .card {
            border: 3px solid transparent; /* Increased border width for visibility */
            transition: all 0.3s ease-in-out;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 16px rgba(0,0,0,0.2);
        }

        .card.selected {
            border-color: #0d6efd; /* Bootstrap primary blue */
            box-shadow: 0 8px 24px rgba(13, 110, 253, 0.3);
            transform: translateY(-5px) scale(1.02);
        }
        
        /* Styles for the Arena */
        #arena-screen { display: none; }

        .fighter-card {
            background-color: white;
            padding: 2rem;
            border-radius: 0.5rem;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .vs-separator {
            font-family: 'Press Start 2P', cursive;
            font-size: 3rem;
            color: #dc3545; /* Bootstrap danger red */
        }

        .card-img-top, .fighter-img {
            height: 200px;
            width: 200px;
            object-fit: cover;
            background-color: #e9ecef;
            border-radius: 50%;
            margin: 0 auto;
            border: 4px solid #dee2e6;
        }

        #battle-log {
            background-color: #212529; /* Dark background for contrast */
            color: #f8f9fa; /* Light text */
            height: 200px;
            overflow-y: scroll;
            padding: 1rem;
            border-radius: 0.25rem;
            font-family: monospace;
            margin-top: 2rem;
        }
        
        /* Mobile horizontal scroll for character selection */
        @media (max-width: 767.98px) {
            .character-selection-row {
                display: flex;
                flex-wrap: nowrap;
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
                padding-bottom: 1rem;
            }
            .character-selection-row .col-md-6 {
                flex: 0 0 80%;
                max-width: 80%;
            }
        }
    </style>
</head>
<body>

    <main class="container my-5">
        <!-- CHARACTER SELECTION SCREEN -->
        <section id="character-selection-screen">
            <header class="text-center mb-5">
                <h1 class="game-title">Kitchen Kombat</h1>
                <p class="lead">Choose Your Culinary Champion!</p>
            </header>
            <div id="character-container" class="row character-selection-row text-center"></div>
            <div class="text-center mt-5">
                <button id="enter-arena-btn" class="btn btn-danger btn-lg" disabled>Enter the Arena!</button>
            </div>
        </section>

        <!-- BATTLE ARENA SCREEN -->
        <section id="arena-screen">
            <header class="text-center mb-5">
                <h1 class="game-title">The Arena</h1>
                <p class="lead">A flavourful fight is imminent!</p>
            </header>
            <div class="row align-items-center">
                <div class="col-md-5 text-center" id="player-fighter-col"></div>
                <div class="col-md-2 text-center d-none d-md-block"><span class="vs-separator">VS</span></div>
                <div class="col-md-5 text-center" id="opponent-fighter-col"></div>
            </div>
            <div id="battle-log">
                <p>The crowd is simmering with anticipation...</p>
            </div>
        </section>
    </main>

    <!-- PRE-BATTLE MODAL -->
    <div class="modal fade" id="itemSelectionModal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="itemSelectionModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="itemSelectionModalLabel">Pantry of Power: Gear Up!</h5>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <!-- Weapon Choices -->
                        <div class="col-lg-6">
                            <h5>Choose a Weapon</h5>
                            <div class="row" id="weapon-choices">
                                <!-- Weapon cards will be injected here -->
                            </div>
                        </div>
                        <!-- Ability Choices -->
                        <div class="col-lg-6">
                            <h5>Choose an Ability</h5>
                             <div class="row" id="ability-choices">
                                <!-- Ability cards will be injected here -->
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-success btn-lg" id="confirm-choices-btn" disabled>Confirm Choices & Fight!</button>
                </div>
            </div>
        </div>
    </div>

    <footer class="text-center text-muted py-4">
        <p>&copy; 2025 Designed by Chris and Emma</p>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" xintegrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>

    <script>
        document.addEventListener('DOMContentLoaded', () => {

            const characters = [
                { id: 'tofu-titan', name: 'Tofu Titan', description: 'A sturdy and resilient fighter...', image: 'https://placehold.co/400x400/C2C2C2/4A4A4A?text=Tofu+Titan', stats: { attack: 6, defense: 10, health: 120 } },
                { id: 'quinoa-queen', name: 'Quinoa Queen', description: 'A flurry of tiny, powerful strikes...', image: 'https://placehold.co/400x400/EADCA6/4A4A4A?text=Quinoa+Queen', stats: { attack: 9, defense: 6, health: 90 } },
                { id: 'avocado-avenger', name: 'Avocado Avenger', description: 'Full of healthy fats and a smooth style...', image: 'https://placehold.co/400x400/8A9A5B/FFFFFF?text=Avocado+Avenger', stats: { attack: 7, defense: 8, health: 100 } },
                { id: 'serrano-samurai', name: 'Spicy Serrano Samurai', description: 'A glass cannon. Incredibly high attack...', image: 'https://placehold.co/400x400/D22B2B/FFFFFF?text=Serrano+Samurai', stats: { attack: 12, defense: 4, health: 75 } }
            ];
            
            // The grand "Pantry of Power" item pool
            const itemPool = [
                { id: 'w01', name: 'Starter Sword', type: 'weapon', description: 'A reliable blade.', statEffect: { attack: 2 } },
                { id: 'w02', name: 'Starter Dagger', type: 'weapon', description: 'Quick and sharp.', statEffect: { attack: 3, defense: -1 } },
                { id: 'w03', name: 'Carrot Clobberer', type: 'weapon', description: '+3 Attack', statEffect: { attack: 3 } },
                { id: 'w04', name: 'Leek Lance', type: 'weapon', description: 'Good for poking.', statEffect: { attack: 2, defense: 1 } },

                { id: 'a01', name: 'Starter Shield', type: 'armor', description: 'Better than nothing.', statEffect: { defense: 2 } },
                { id: 'a02', name: 'Cabbage Pauldron', type: 'armor', description: 'Surprisingly sturdy.', statEffect: { defense: 3 } },
                { id: 'a03', name: 'Garlic Ward', type: 'armor', description: 'Keeps foes at bay.', statEffect: { defense: 1, health: 5 } },

                { id: 'ab01', name: 'Spicy Spit', type: 'ability', description: 'A fiery ranged attack.', character: 'serrano-samurai' },
                { id: 'ab02', name: 'Green Ooze', type: 'ability', description: 'Slows the opponent.', character: 'avocado-avenger' },
                { id: 'ab03', name: 'Fortify', type: 'ability', description: 'Boosts defense for 3 turns.', statEffect: { defense: 4 }},
                { id: 'ab04', name: 'Sharpen', type: 'ability', description: 'Boosts attack for 3 turns.', statEffect: { attack: 4 }},
                { id: 'ab05', name: 'First Aid', type: 'ability', description: 'Heal for 20 health.', statEffect: { health: 20 }},
            ];

            const characterContainer = document.getElementById('character-container');
            const enterArenaBtn = document.getElementById('enter-arena-btn');
            const charSelectionScreen = document.getElementById('character-selection-screen');
            const arenaScreen = document.getElementById('arena-screen');
            const itemModalEl = document.getElementById('itemSelectionModal');
            const itemModal = new bootstrap.Modal(itemModalEl);
            const confirmChoicesBtn = document.getElementById('confirm-choices-btn');

            let playerCharacter = null;
            let opponentCharacter = null;
            let playerInBattle = null; // A copy of the player character for the current battle
            let selectedWeapon = null;
            let selectedAbility = null;

            function renderCharacters() { /* ... (same as before) ... */ }
            renderCharacters(); // Simplified for brevity, function is unchanged

            characterContainer.addEventListener('click', (event) => { /* ... (same as before) ... */ }); // Unchanged

            function createFighterDisplay(character, isPlayer = false) {
                const charId = isPlayer ? 'player' : 'opponent';
                return `
                    <div class="fighter-card">
                        <img src="${character.image}" alt="${character.name}" class="fighter-img mb-3">
                        <h2>${character.name}</h2>
                        <ul class="list-unstyled">
                            <li><strong>Health:</strong> <span id="${charId}-health">${character.stats.health}</span></li>
                            <li><strong>Attack:</strong> <span id="${charId}-attack">${character.stats.attack}</span></li>
                            <li><strong>Defense:</strong> <span id="${charId}-defense">${character.stats.defense}</span></li>
                        </ul>
                    </div>`;
            }

            function populateItemModal() {
                const weaponChoicesContainer = document.getElementById('weapon-choices');
                const abilityChoicesContainer = document.getElementById('ability-choices');
                
                // Get 3 random weapons (for now, includes armor)
                const weapons = itemPool.filter(item => item.type === 'weapon' || item.type === 'armor');
                const randomWeapons = [...weapons].sort(() => 0.5 - Math.random()).slice(0, 3);
                
                // Get 3 random abilities
                const abilities = itemPool.filter(item => item.type === 'ability');
                const randomAbilities = [...abilities].sort(() => 0.5 - Math.random()).slice(0, 3);

                const createItemCard = (item) => `
                    <div class="col-md-4 mb-3">
                        <div class="card h-100 item-card" data-item-id="${item.id}" data-item-type="${item.type}">
                            <div class="card-body">
                                <h6 class="card-title">${item.name}</h6>
                                <p class="card-text small">${item.description}</p>
                            </div>
                        </div>
                    </div>`;

                weaponChoicesContainer.innerHTML = randomWeapons.map(createItemCard).join('');
                abilityChoicesContainer.innerHTML = randomAbilities.map(createItemCard).join('');
            }

            itemModalEl.addEventListener('click', (event) => {
                const card = event.target.closest('.item-card');
                if (!card) return;

                const itemId = card.dataset.itemId;
                const itemType = card.dataset.itemType;
                
                if (itemType === 'weapon' || itemType === 'armor') {
                    document.querySelectorAll('#weapon-choices .item-card').forEach(c => c.classList.remove('selected'));
                    selectedWeapon = itemPool.find(item => item.id === itemId);
                } else if (itemType === 'ability') {
                    document.querySelectorAll('#ability-choices .item-card').forEach(c => c.classList.remove('selected'));
                    selectedAbility = itemPool.find(item => item.id === itemId);
                }
                
                card.classList.add('selected');

                if (selectedWeapon && selectedAbility) {
                    confirmChoicesBtn.disabled = false;
                }
            });

            confirmChoicesBtn.addEventListener('click', () => {
                // Apply stat changes from items
                if (selectedWeapon.statEffect) {
                    for (const stat in selectedWeapon.statEffect) {
                        playerInBattle.stats[stat] += selectedWeapon.statEffect[stat];
                    }
                }
                if (selectedAbility.statEffect) {
                    for (const stat in selectedAbility.statEffect) {
                        playerInBattle.stats[stat] += selectedAbility.statEffect[stat];
                    }
                }

                // Update the UI with new stats
                document.getElementById('player-health').textContent = playerInBattle.stats.health;
                document.getElementById('player-attack').textContent = playerInBattle.stats.attack;
                document.getElementById('player-defense').textContent = playerInBattle.stats.defense;

                itemModal.hide();
                console.log("Player is ready to fight with:", playerInBattle);
                document.getElementById('battle-log').innerHTML += `<p>You are equipped with ${selectedWeapon.name} and the ${selectedAbility.name} ability. The fight begins!</p>`;
            });

            enterArenaBtn.addEventListener('click', () => {
                if (!playerCharacter) return;
                
                // Create a deep copy of the player character for this battle instance
                playerInBattle = JSON.parse(JSON.stringify(playerCharacter));

                const availableOpponents = characters.filter(char => char.id !== playerCharacter.id);
                opponentCharacter = availableOpponents[Math.floor(Math.random() * availableOpponents.length)];
                
                document.getElementById('player-fighter-col').innerHTML = createFighterDisplay(playerInBattle, true);
                document.getElementById('opponent-fighter-col').innerHTML = createFighterDisplay(opponentCharacter);

                charSelectionScreen.style.display = 'none';
                arenaScreen.style.display = 'block';

                populateItemModal();
                itemModal.show();
            });

            // --- Reset function for re-rendering character cards (unchanged) ---
            function renderCharacters() {
                characterContainer.innerHTML = characters.map(char => `
                    <div class="col-12 col-md-6 col-lg-3 mb-4">
                        <div class="card h-100" data-character-id="${char.id}">
                            <img src="${char.image}" class="card-img-top" alt="${char.name}">
                            <div class="card-body d-flex flex-column">
                                <h5 class="card-title">${char.name}</h5>
                                <p class="card-text">${char.description}</p>
                                <ul class="list-group list-group-flush mb-3">
                                    <li class="list-group-item"><strong>Health:</strong> ${char.stats.health}</li>
                                    <li class="list-group-item"><strong>Attack:</strong> ${char.stats.attack}</li>
                                    <li class="list-group-item"><strong>Defense:</strong> ${char.stats.defense}</li>
                                </ul>
                                <button class="btn btn-outline-primary mt-auto select-btn">Select ${char.name}</button>
                            </div>
                        </div>
                    </div>
                `).join('');
            }
            // --- Reset function for character selection (unchanged) ---
            characterContainer.addEventListener('click', (event) => {
                if (event.target.classList.contains('select-btn')) {
                    const clickedCard = event.target.closest('.card');
                    const characterId = clickedCard.dataset.characterId;
                    document.querySelectorAll('#character-container .card').forEach(card => card.classList.remove('selected'));
                    clickedCard.classList.add('selected');
                    playerCharacter = characters.find(char => char.id === characterId);
                    enterArenaBtn.disabled = false;
                }
            });
        });
    </script>
</body>
</html>

